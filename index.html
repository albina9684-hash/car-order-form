<script>
document.getElementById('carForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const data = {
    name: document.getElementById('name').value,
    phone: document.getElementById('phone').value,
    telegram: document.getElementById('telegram').value,
    from: document.getElementById('from').value,
    car: document.getElementById('car').value,
    budget: document.getElementById('budget').value
  };

  const WEBHOOK = 'https://b24-ynu924.bitrix24.ru/rest/1/oj5dbvbaueer7z1g/crm.lead.add.json';

  const body = {
    fields: {
      TITLE: `Заявка: ${data.name}`,
      NAME: data.name,
      PHONE: [
        {
          VALUE: data.phone,
          VALUE_TYPE: "WORK"
        }
      ],
      COMMENTS:
        `Telegram: ${data.telegram}\n` +
        `Откуда авто: ${data.from}\n` +
        `Марка / модель: ${data.car}\n` +
        `Бюджет: ${data.budget} ₽`
    }
  };

  fetch(WEBHOOK, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(body)
  })
  .then(response => response.json())
  .then(() => {
    alert('Заявка отправлена!');
    document.getElementById('carForm').reset();
  })
  .catch(error => {
    console.error(error);
    alert('Ошибка отправки');
  });
});
</script>
