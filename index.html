<script>
document.getElementById('carForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const name = document.getElementById('name').value || 'Без имени';
  const phone = document.getElementById('phone').value;
  const telegram = document.getElementById('telegram').value;
  const country = document.getElementById('country').value;
  const car = document.getElementById('car').value;
  const budget = document.getElementById('budget').value;

  const body = {
    fields: {
      TITLE: 'Заявка: ' + name,
      NAME: name,
      PHONE: [{
        VALUE: phone,
        VALUE_TYPE: 'WORK'
      }],
      COMMENTS:
        'Telegram: ' + telegram + '\n' +
        'Откуда авто: ' + country + '\n' +
        'Марка / модель: ' + car + '\n' +
        'Бюджет: ' + budget + ' ₽'
    }
  };

  fetch('https://b24-ynu924.bitrix24.ru/rest/1/oj5dbvbaueer7z1g/crm.lead.add.json', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(body)
  })
  .then(() => {
    alert('Заявка отправлена');
    document.getElementById('carForm').reset();
  })
  .catch(() => {
    alert('Ошибка отправки');
  });
});
</script>
